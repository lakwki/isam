--select '''' + c.contractno + '-' + c.deliveryno + ''',', a.contractno, b.deliveryno, b.workflowstatusid, d.* ,b.* 
select a.contractno, b.deliveryno, b.customeratwarehousedate, dbo.fn_formatinvoiceno(i.invoiceprefix, i.invoiceseq, i.invoiceyear) as invoiceno, d.invoicedate, d.invoiceno as selfbilled_invoiceno, 
case when datepart(hh,d.processeddate)=0 and datepart(mi,d.processeddate)=0 and datepart(ss,d.processeddate)=0 then 'MANUAL INVOICE' else 'SYSTEM INVOICE' END as upload_mode, w.description as workflow_status
from contract a inner join shipment b on a.contractid = b.contractid and a.status = 1 and b.status = 1 and a.contractno + '-' + convert(varchar, b.deliveryno) in (
'OG8484563-1',
'OG8484576-1',
'OG8484741-2',
'OG8482691-2',
'OG8483302-3',
'OG8485067-1',
'UH8478786-5',
'UH8478786-3',
'MI8492843-4',
'OG8484699-1',
'OG8484709-1',
'OG8484880-1',
'UH8476254-3',
'UH8478786-4',
'VA8479196-1',
'VQ8465964-1',
'VA8479581-1',
'VI8478058-1',
'VI8477923-1',
'VQ8466138-1',
'VB8491695-2',
'VJ8492830-1',
'MF8452582-2',
'VJ8492226-4',
'YB8476416-1',
'VJ8492830-3',
'VB8491718-2',
'YB8476403-1',
'AJ8433734-1',
'AJ8433721-1',
'AJ8434461-1',
'MB8474023-3',
'MB8477075-1',
'AJ8433734-1',
'AJ8433721-1',
'AJ8434461-1',
'OG8484563-1',
'OG8484576-1',
'OG8484741-2',
'OG8482691-2',
'OG8483302-3',
'OG8485067-1',
'UH8478786-5',
'UH8478786-3',
'MI8492843-4',
'OG8484699-1',
'OG8484709-1',
'OG8484880-1',
'UH8476254-3',
'UH8478786-4',
'VA8479196-1',
'VQ8465964-1',
'VA8479581-1',
'VI8478058-1',
'VI8477923-1',
'VQ8466138-1',
'VB8491695-2',
'VJ8492830-1',
'MF8452582-2',
'VJ8492226-4',
'YB8476416-1',
'VJ8492830-3',
'VB8491718-2',
'YB8476403-1',
'AJ8433734-1',
'AJ8433721-1',
'AJ8434461-1',
'MB8474023-3',
'MB8477075-1',
'AJ8433734-1',
'AJ8433721-1',
'AJ8434461-1',
'YB8477431-1',
'PA8452236-1',
'OF8472397-1',
'OF8472384-1',
'VA8482963-1',
'AD8575689-2',
'VA8478935-2',
'VA8480253-3',
'AD8575702-3',
'OF8472384-1',
'MB8474023-3',
'VB8490544-2',
'VJ8490890-1',
'VB8490379-4',
'PZ8431891-1',
'OV8452045-2',
'PZ8431833-1',
'VI8476092-1',
'MB8473095-3',
'OV8452058-1',
'AV8651927-1',
'OH8459637-3',
'OH8458735-2',
'VQ8463458-1',
'VA8482963-2',
'VI8476089-1',
'VQ8465731-2',
'VQ8465744-1',
'VA8482989-1',
'MD8489678-1',
'VJ8491789-1',
'VA8478472-1',
'OH8458557-2',
'VQ8466028-3',
'MD8489775-2',
'VJ8490900-1',
'CX8447982-1',
'AD8579025-3',
'VQ8464965-1',
'MD8489681-1',
'MD8489704-1',
'VQ8464965-2',
'MD8489717-1',
'AD8579012-2',
'VL8442314-1',
'MI8491543-1',
'OV8452278-1',
'OI8517472-2',
'OV8452265-1',
'OI8417485-2',
'OI8417485-1',
'SN8467522-1',
'MA8467690-1',
'MA8467700-1',
'MA8467700-1',
'OI8518002-1',
'AV8645360-1',
'BG8468738-1',
'AV8649065-1',
'VQ8465142-1',
'VQ8465126-1',
'VQ8464949-1',
'VA8479154-1',
'VI8477978-1',
'MB8476403-1',
'MA8467700-2',
'MI8491598-3',
'MI8491530-4',
'OF8472384-3',
'SN8467522-2',
'PZ8431817-2',
'PZ8431820-2',
'PZ8431846-1',
'PZ8431888-1',
'PZ8431901-1',
'SN8467137-1',
'PZ8431804-2',
'BG8468657-1',
'BG8468660-1',
'BG8468660-2',
'BG8468673-1',
'AV8649010-1',
'AV8647915-2',
'AV8649010-1',
'BG8468657-1',
'BG8468660-1',
'BG8468660-2',
'BG8468673-1',
'HZ8441658-1',
'HZ8441700-1',
'HZ8442097-1',
'HZ8442107-1',
'HZ8442110-1',
'HZ8442123-1',
'HZ8442136-1',
'HZ8442149-1',
'MA8467687-1',
'MA8467690-2',
'MA8467700-2',
'MA8468110-1',
'MA8468518-1',
'MA8468521-1',
'MA8469290-3',
'MA8469300-1',
'MB8474793-3',
'MB8474803-1',
'MB8474803-3',
'MB8476076-3',
'MD8489678-2',
'MD8489704-2',
'ME8453785-1',
'MI8491530-2',
'MI8491598-3',
'MP8444493-1',
'OB8476034-1',
'OF8472384-3',
'OG8484424-1',
'OG8484437-1',
'OG8484673-1',
'OH8457833-2',
'OH8458256-1',
'OH8458764-2',
'OH8460040-1',
'OI8417485-2',
'OI8417485-1',
'OI8516842-2',
'OI8516855-1',
'OI8516855-2',
'OI8517469-1',
'OI8518015-1',
'OI8518727-1',
'OI8518727-2',
'OI8518769-1',
'OI8518772-1',
'OI8518798-2',
'OX8452139-2',
'OX8452139-3',
'OX8452249-1',
'OX8452252-1',
'OX8452252-3',
'PZ8431804-1',
'PZ8431817-2',
'PZ8431820-1',
'PZ8431846-1',
'PZ8431888-1',
'PZ8431901-1',
'SN8464800-2',
'SN8467137-1',
'SN8467522-2',
'VA8479109-1',
'VA8479109-3',
'VA8479646-1',
'VA8482950-1',
'VB8487036-1',
'VB8490379-2',
'VB8490379-3',
'VB8490557-1',
'VI8477169-2',
'VI8477266-3',
'VJ8490722-1',
'VJ8491446-1',
'VJ8491446-3',
'VJ8492429-1',
'VJ8492445-1',
'VQ8464949-1',
'VQ8465032-1',
'VQ8465126-1',
'VQ8465139-1',
'VQ8465142-1',
'VQ8467412-1',
'ZD8442042-1',
'ZD8442314-1',
'ZD8442327-1',
'ZD8442343-1',
'ZD8442369-1',
'ZI8430067-1',
'ZW8443300-1',
'ZW8443313-1',
'ZX8449508-1',
'ZX8449511-1',
'ZX8449867-1',
'AV8647915-2',
'AV8649010-1',
'BG8468657-1',
'BG8468660-1',
'BG8468660-2',
'BG8468673-1',
'HZ8441658-1',
'HZ8441700-1',
'HZ8442097-1',
'HZ8442107-1',
'HZ8442110-1',
'HZ8442123-1',
'HZ8442136-1',
'HZ8442149-1',
'MA8467687-1',
'MA8467690-2',
'MA8467700-2',
'MA8468110-1',
'MA8468518-1',
'MA8468521-1',
'MA8469290-3',
'MA8469300-1',
'MB8474793-3',
'MB8474803-1',
'MB8474803-3',
'MB8476076-3',
'MD8489678-2',
'MD8489704-2',
'ME8453785-1',
'MI8491530-2',
'MI8491598-3',
'MP8444493-1',
'OB8476034-1',
'OF8472384-3',
'OG8484424-1',
'OG8484437-1',
'OG8484673-1',
'OH8457833-2',
'OH8458256-1',
'OH8458764-2',
'OH8460040-1',
'OI8417485-2',
'OI8417485-1',
'OI8516842-2',
'OI8516855-1',
'OI8516855-2',
'OI8517469-1',
'OI8518015-1',
'OI8518727-1',
'OI8518727-2',
'OI8518769-1',
'OI8518772-1',
'OI8518798-2',
'OX8452139-2',
'OX8452139-3',
'OX8452249-1',
'OX8452252-1',
'OX8452252-3',
'PZ8431804-1',
'PZ8431817-2',
'PZ8431820-1',
'PZ8431846-1',
'PZ8431888-1',
'PZ8431901-1',
'SN8464800-2',
'SN8467137-1',
'SN8467522-2',
'VA8479109-1',
'VA8479109-3',
'VA8479646-1',
'VA8482950-1',
'VB8487036-1',
'VB8490379-2',
'VB8490379-3',
'VB8490557-1',
'VI8477169-2',
'VI8477266-3',
'VJ8490722-1',
'VJ8491446-1',
'VJ8491446-3',
'VJ8492429-1',
'VJ8492445-1',
'VQ8464949-1',
'VQ8465032-1',
'VQ8465126-1',
'VQ8465139-1',
'VQ8465142-1',
'VQ8467412-1',
'ZD8442042-1',
'ZD8442314-1',
'ZD8442327-1',
'ZD8442343-1',
'ZD8442369-1',
'ZI8430067-1',
'ZW8443300-1',
'ZW8443313-1',
'ZX8449508-1',
'ZX8449511-1',
'ZX8449867-1',
'AV8647915-2',
'AV8649010-1',
'BG8468657-1',
'BG8468660-1',
'BG8468660-2',
'BG8468673-1',
'HZ8441658-1',
'HZ8441700-1',
'HZ8442097-1',
'HZ8442107-1',
'HZ8442110-1',
'HZ8442123-1',
'HZ8442136-1',
'HZ8442149-1',
'MA8467687-1',
'MA8467690-2',
'MA8467700-2',
'MA8468110-1',
'MA8468518-1',
'MA8468521-1',
'MA8469290-3',
'MA8469300-1',
'MB8474793-3',
'MB8474803-1',
'MB8474803-3',
'MB8476076-3',
'MD8489678-2',
'MD8489704-2',
'ME8453785-1',
'MI8491530-2',
'MI8491598-3',
'MP8444493-1',
'OB8476034-1',
'OF8472384-3',
'OG8484424-1',
'OG8484437-1',
'OG8484673-1',
'OH8457833-2',
'OH8458256-1',
'OH8458764-2',
'OH8460040-1',
'OI8417485-2',
'OI8417485-1',
'OI8516842-2',
'OI8516855-1',
'OI8516855-2',
'OI8517469-1',
'OI8518015-1',
'OI8518727-1',
'OI8518727-2',
'OI8518769-1',
'OI8518772-1',
'OI8518798-2',
'OX8452139-2',
'OX8452139-3',
'OX8452249-1',
'OX8452252-1',
'OX8452252-3',
'PZ8431804-1',
'PZ8431817-2',
'PZ8431820-1',
'PZ8431846-1',
'PZ8431888-1',
'PZ8431901-1',
'SN8464800-2',
'SN8467137-1',
'SN8467522-2',
'VA8479109-1',
'VA8479109-3',
'VA8479646-1',
'VA8482950-1',
'VB8487036-1',
'VB8490379-2',
'VB8490379-3',
'VB8490557-1',
'VI8477169-2',
'VI8477266-3',
'VJ8490722-1',
'VJ8491446-1',
'VJ8491446-3',
'VJ8492429-1',
'VJ8492445-1',
'VQ8464949-1',
'VQ8465032-1',
'VQ8465126-1',
'VQ8465139-1',
'VQ8465142-1',
'VQ8467412-1',
'ZD8442042-1',
'ZD8442314-1',
'ZD8442327-1',
'ZD8442343-1',
'ZD8442369-1',
'ZI8430067-1',
'ZW8443300-1',
'ZW8443313-1',
'ZX8449508-1',
'ZX8449511-1',
'ZX8449867-1'
)
left join ilsorderref c on c.shipmentid = b.shipmentid left join ilsinvoice d on c.orderrefid = d.orderrefid 
inner join workflowstatus w on b.workflowstatusid = w.workflowstatusid and w.recordtypeid = 1
inner join invoice i on i.shipmentid = b.shipmentid 
order by 4


--select 

--select * from product where itemno = '891918'
